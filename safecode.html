<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üîê SafeCode Checker (Pyodide)</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
  <style>
    :root {
      --bg-color: #f0f2f5;
      --container-bg: #ffffff;
      --text-color: #333;
      --input-bg: #f9f9f9;
      --input-border: #ccc;
      --highlight-color: #007acc;
      --result-bg: #f6f8fa;
    }

    body.dark {
      --bg-color: #181a1b;
      --container-bg: #242526;
      --text-color: #f1f1f1;
      --input-bg: #2f2f2f;
      --input-border: #444;
      --highlight-color: #5ab0ff;
      --result-bg: #2a2a2a;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      margin: 0;
      padding: 0px;
      display: block;
      justify-content: center;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    .container {
      width: 100%;
      max-width: 1000px;
      background-color: var(--container-bg);
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
    }

    h1 {
      font-size: 1.8rem;
      margin-bottom: 10px;
    }

    p {
      margin-bottom: 20px;
    }

    .theme-toggle {
      float: right;
      margin-top: -40px;
      cursor: pointer;
      font-size: 1.2rem;
      background: none;
      border: none;
      color: var(--text-color);
    }

    textarea {
      width: 100%;
      height: 250px;
      font-family: monospace;
      font-size: 15px;
      padding: 15px;
      border: 1px solid var(--input-border);
      border-radius: 12px;
      background-color: var(--input-bg);
      color: var(--text-color);
      transition: background-color 0.3s, color 0.3s, border-color 0.3s;
    }

    textarea:focus {
      border-color: var(--highlight-color);
      outline: none;
      background-color: #fff;
    }

    body.dark textarea:focus {
      background-color: #1e1e1e;
    }

    button {
      margin-top: 16px;
      padding: 12px 24px;
      font-size: 1rem;
      font-weight: 600;
      background-color: var(--highlight-color);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #005fa3;
    }

    #result {
      margin-top: 24px;
      font-size: 1rem;
      background-color: var(--result-bg);
      padding: 16px;
      border-left: 6px solid var(--highlight-color);
      border-radius: 8px;
      color: var(--text-color);
    }

    #result ul {
      padding-left: 20px;
      margin-top: 10px;
    }

    #result li {
      margin-bottom: 6px;
    }

    @media (max-width: 600px) {
      .container {
        padding: 20px;
      }

      h1 {
        font-size: 1.5rem;
      }

      textarea {
        height: 200px;
      }
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">üîê SafeCode</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
      <span class="navbar-toggler-icon"></span>
    </button>
    
    <div class="collapse navbar-collapse" id="navbarContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link active" href="safecode.html">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="How it work.html">How it works</a></li>
        <li class="nav-item"><a class="nav-link" href="About me.html">About</a></li>
        <li class="nav-item"><a class="nav-link" href="#">GitHub</a></li>
      </ul>
      
  </div>
</nav>


<div class="container-fluid mt-3">
  <h3></h3>
  <p></p>
</div>

  <div class="container">
    <button class="theme-toggle" onclick="toggleTheme()">üåô</button>
    <h1>üîê SafeCode Checker (Python in Browser)</h1>
    <p>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏î Python</p>
    <p>Example of unsecured Python code: eval("print('Hacked!')") </p>
    <textarea id="codeInput" placeholder="‡πÉ‡∏™‡πà‡πÇ‡∏Ñ‡πâ‡∏î Python ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..."></textarea>
    <br>
    <button onclick="checkCode()">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</button>
    <div id="result">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î Pyodide...</div>
  </div>

  <script>
    let pyodideReady = false;
    let pyodide;

    async function loadPyodideAndPackages() {
      pyodide = await loadPyodide();
      await pyodide.loadPackage("micropip");
      pyodideReady = true;
      document.getElementById("result").innerText = "‚úÖ Pyodide ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß";
    }

    async function checkCode() {
      if (!pyodideReady) return alert("Pyodide ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°");

      const code = document.getElementById("codeInput").value;
      const resultDiv = document.getElementById("result");

      try {
        pyodide.globals.set("code", code);

        const script = `
import ast

def is_valid_python(code):
    try:
        tree = ast.parse(code)
        if not code.strip() or code.strip().startswith("#"):
            return False
        if len(tree.body) == 1:
            node = tree.body[0]
            if isinstance(node, ast.Expr):
                if isinstance(node.value, (ast.Constant, ast.Name)):
                    return False
        return True
    except:
        return False

def check_code(code):
    results = []
    if "eval(" in code:
        results.append(("eval()", "‡πÉ‡∏ä‡πâ eval() ‡∏≠‡∏≤‡∏à‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢"))
    if "exec(" in code:
        results.append(("exec()", "‡πÉ‡∏ä‡πâ exec() ‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡∏¥‡∏î‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ"))
    if "os.system(" in code:
        results.append(("os.system()", "‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ô‡∏µ‡πâ‡∏≠‡∏≤‡∏à‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á shell ‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å"))
    if '"SELECT ' in code or "'SELECT " in code:
        results.append(("SQL query string", "‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô SQL ‡πÅ‡∏ö‡∏ö‡∏ï‡πà‡∏≠ string ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á SQL Injection"))
    return results

valid = is_valid_python(code)
issues = check_code(code) if valid else []
        `;

        await pyodide.runPythonAsync(script);
        const valid = pyodide.globals.get("valid");
        const issues = pyodide.globals.get("issues").toJs();

        if (!valid) {
          resultDiv.innerHTML = "‚ö†Ô∏è ‡πÇ‡∏Ñ‡πâ‡∏î‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà Python ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
        } else if (issues.length > 0) {
          resultDiv.innerHTML = "‚ö†Ô∏è ‡∏û‡∏ö‡∏à‡∏∏‡∏î‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á:<ul>" +
            issues.map(([i, msg]) => `<li>${i} ‚Üí ${msg}</li>`).join('') +
            "</ul>";
        } else {
          resultDiv.innerHTML = "‚úÖ ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏à‡∏∏‡∏î‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô";
        }

      } catch (err) {
        resultDiv.innerText = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + err;
      }
    }

    // üåó Theme toggle
    function toggleTheme() {
      const body = document.body;
      const toggle = document.querySelector('.theme-toggle');
      body.classList.toggle('dark');
      const dark = body.classList.contains('dark');
      toggle.textContent = dark ? "üåû" : "üåô";
      localStorage.setItem("darkMode", dark ? "on" : "off");
    }

    // Detect system or saved preference
    (function () {
      const savedTheme = localStorage.getItem("darkMode");
      if (
        savedTheme === "on" ||
        (savedTheme === null && window.matchMedia('(prefers-color-scheme: dark)').matches)
      ) {
        document.body.classList.add("dark");
        document.querySelector('.theme-toggle').textContent = "üåû";
      }
    })();

    loadPyodideAndPackages();
  </script>
</body>
</html>
